---
title: "NHL Dashboard Graphs"
author: "Nick Sofianakos"
date: "2024-07-14"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(dplyr)
library(tidyquant)
library(pacman)
library(devtools)
library(ggforce)
library(plotly)
library(ggimage)
library(scales)
library(ggthemes)
library(RCurl)
centertitle <- theme(plot.title = element_text(hjust = 0.5))
centersub <- theme(plot.subtitle = element_text(hjust = 0.5))
```

Alright time to make some graphs now that packages are loaded in
```{r}
ASAS <- read_csv("AllStrengthsAllScoresCounts.csv")
NHL_Logos <- read_csv("nhl_logos.csv")
```

```{r}
AS_AllScores <- left_join(ASAS,NHL_Logos,
                           by= c("Team"= "espn_team_name"))
```
Selecting only espn_logo, xGA,xGF from the dataframe to avoid null values messing it up.
```{r}

viz1 <- AS_AllScores %>% 
  select(espn_logo,xGF,xGA) %>% 
  mutate(espn_logo=replace_na(espn_logo,"https://a.espncdn.com/i/teamlogos/nhl/500/stl.png"))
```


Making Graph: All Strengths, All Scores, xGF vs xGA
```{r}
mean_xGF <- mean(viz1$xGF, na.rm = TRUE)
mean_xGA <- mean(viz1$xGA, na.rm = TRUE)
asp <- 1.618
width<- 20


viz1 %>% 
  ggplot(aes(x=xGA,y=xGF,image=espn_logo))+
  geom_image(size=0.06, asp=asp)+
  labs(title= "NHL 2023-2024",
        subtitle = "xGF vs xGA (All Strengths,All Scores)",
        x= "xGA",
        y= "xGF",
        caption= "Data Source: Natural Stat Trick")+
   centertitle+
   centersub +
    geom_hline(yintercept = mean_xGF, color = "white", linetype = "dashed") +
  geom_vline(xintercept = mean_xGA, color = "white", linetype = "dashed") +
       annotate("text", x = 235, y = 225, 
                label = "Bad Offense/Good Defense", color="white") +
       annotate("text", x = 235, y = 290,
                label = "Good Offense/Good Defense", color="white") + 
       annotate("text", x = 280, y = 225,
                label = "Bad Offense/Bad Defense", color="white") + 
       annotate("text", x = 280, y = 290,
                label = "Good Offense/Bad Defense", color="white")+
  theme_minimal(base_family = "Arial") + # Use a minimal theme as the base
  theme(
    plot.background = element_rect(fill = "#282a36", color = NA),
    panel.background = element_rect(fill = "#282a36", color = NA),
    plot.title = element_text(color = "white", hjust = 0.5),
    plot.subtitle = element_text(color = "white", hjust = 0.5),
    plot.caption = element_text(color = "white"),
    axis.title.x = element_text(color = "white"),
    axis.title.y = element_text(color = "white"),
    axis.text = element_text(color = "white"),
    panel.grid.major = element_blank(), # Remove major grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines

  )

```

Saving the plot Attempt better(WORKS GREAT!!!!!!)
```{r}
ggsave(filename = "nhl_2023_2024_ASAS.png", dpi=600, width = width, height = width/asp, units = "cm")
```

Now, we have successfully made an Expected Goals For vs Expected Goals Against plot for the 2023-24 regular season for All Scores and Strengths. Going to keep making the same graph but for different scores and strengths. 

2)All Strengths, and Tied

Load in the data
```{r}
AST <- read_csv("AllStrengthsTiedCounts.csv")
```

Merge with NHL Logo Data
```{r}
AS_Tied <- left_join(AST,NHL_Logos,
                           by= c("Team"= "espn_team_name"))
```

Select Team Logo, xGF, xGA
```{r}
viz2 <- AS_Tied %>% 
  select(espn_logo,xGF,xGA) %>% 
  mutate(espn_logo=replace_na(espn_logo,"https://a.espncdn.com/i/teamlogos/nhl/500/stl.png"))
```

Making the Graph: All Strengths, and Tied
```{r}
mean_xGF_ASTied <- mean(viz2$xGF, na.rm = TRUE)
mean_xGA_ASTied <- mean(viz2$xGA, na.rm = TRUE)
asp <- 1.618
width<- 20

#50 to 115 in both direction for limits
viz2 %>% 
  ggplot(aes(x=xGA,y=xGF,image=espn_logo))+
  geom_image(size=0.06, asp=asp)+
  labs(title= "NHL 2023-2024",
        subtitle = "xGF vs xGA (All Strengths, Tied)",
        x= "xGA",
        y= "xGF",
        caption= "Data Source: Natural Stat Trick")+
   centertitle+
   centersub +
    geom_hline(yintercept = mean_xGF_ASTied, color = "white", linetype = "dashed") +
  geom_vline(xintercept = mean_xGA_ASTied, color = "white", linetype = "dashed") +
       annotate("text", x = 72, y = 62.5, 
                label = "Bad Offense/Good Defense", color="white") +
       annotate("text", x = 72, y = 110,
                label = "Good Offense/Good Defense", color="white") +
       annotate("text", x = 100, y = 62.5,
                label = "Bad Offense/Bad Defense", color="white") + 
       annotate("text", x = 100, y = 110,
                label = "Good Offense/Bad Defense", color="white")+
  theme_minimal(base_family = "Arial") + # Use a minimal theme as the base
  theme(
    plot.background = element_rect(fill = "#282a36", color = NA),
    panel.background = element_rect(fill = "#282a36", color = NA),
    plot.title = element_text(color = "white", hjust = 0.5),
    plot.subtitle = element_text(color = "white", hjust = 0.5),
    plot.caption = element_text(color = "white"),
    axis.title.x = element_text(color = "white"),
    axis.title.y = element_text(color = "white"),
    axis.text = element_text(color = "white"),
    panel.grid.major = element_blank(), # Remove major grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines

  )
```
Saving the graph to a png
```{r}
ggsave(filename = "nhl_2023_2024_ASTied.png", dpi=600, width = width, height = width/asp, units = "cm")
```



3)All Strengths, and Leading

Load in the data
```{r}
ASL <- read_csv("AllStrengthsLeadingCounts.csv")
```

Merge with NHL Logo Data
```{r}
AS_Leading <- left_join(ASL,NHL_Logos,
                           by= c("Team"= "espn_team_name"))
```

Select Team Logo, xGF, xGA
```{r}
viz3 <- AS_Leading %>% 
  select(espn_logo,xGF,xGA) %>% 
  mutate(espn_logo=replace_na(espn_logo,"https://a.espncdn.com/i/teamlogos/nhl/500/stl.png"))
```

Making the Graph: All Strengths, and Tied
```{r}
mean_xGF_ASLeading <- mean(viz3$xGF, na.rm = TRUE)
mean_xGA_ASLeading <- mean(viz3$xGA, na.rm = TRUE)
asp <- 1.618
width<- 20

#50 to 115 in both direction for limits
viz3 %>% 
  ggplot(aes(x=xGA,y=xGF,image=espn_logo))+
  geom_image(size=0.06, asp=asp)+
  labs(title= "NHL 2023-2024",
        subtitle = "xGF vs xGA (All Strengths, Leading)",
        x= "xGA",
        y= "xGF",
        caption= "Data Source: Natural Stat Trick")+
   centertitle+
   centersub +
    geom_hline(yintercept = mean_xGF_ASLeading, color = "white", linetype = "dashed") +
  geom_vline(xintercept = mean_xGA_ASLeading, color = "white", linetype = "dashed") +
       annotate("text", x = 72, y = 62.5, 
                label = "Bad Offense/Good Defense", color="white") +
       annotate("text", x = 72, y = 110,
                label = "Good Offense/Good Defense", color="white") +
       annotate("text", x = 100, y = 62.5,
                label = "Bad Offense/Bad Defense", color="white") + 
       annotate("text", x = 100, y = 110,
                label = "Good Offense/Bad Defense", color="white")+
  theme_minimal(base_family = "Arial") + # Use a minimal theme as the base
  theme(
    plot.background = element_rect(fill = "#282a36", color = NA),
    panel.background = element_rect(fill = "#282a36", color = NA),
    plot.title = element_text(color = "white", hjust = 0.5),
    plot.subtitle = element_text(color = "white", hjust = 0.5),
    plot.caption = element_text(color = "white"),
    axis.title.x = element_text(color = "white"),
    axis.title.y = element_text(color = "white"),
    axis.text = element_text(color = "white"),
    panel.grid.major = element_blank(), # Remove major grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines

  )
```
Saving the graph to a png
```{r}
ggsave(filename = "nhl_2023_2024_ASLeading.png", dpi=600, width = width, height = width/asp, units = "cm")
```

4)All Strengths, and Trailing

Load in the data
```{r}
ASTrail <- read_csv("AllStrengthsTrailingCounts.csv")
```

Merge with NHL Logo Data
```{r}
AS_Trailing <- left_join(ASTrail,NHL_Logos,
                           by= c("Team"= "espn_team_name"))
```

Select Team Logo, xGF, xGA
```{r}
viz4 <- AS_Trailing %>% 
  select(espn_logo,xGF,xGA) %>% 
  mutate(espn_logo=replace_na(espn_logo,"https://a.espncdn.com/i/teamlogos/nhl/500/stl.png"))
```

Making the Graph: All Strengths, and Tied
```{r}
mean_xGF_ASTrailing <- mean(viz4$xGF, na.rm = TRUE)
mean_xGA_ASTrailing <- mean(viz4$xGA, na.rm = TRUE)
asp <- 1.618
width<- 20

#50 to 115 in both direction for limits
viz4 %>% 
  ggplot(aes(x=xGA,y=xGF,image=espn_logo))+
  geom_image(size=0.06, asp=asp)+
  labs(title= "NHL 2023-2024",
        subtitle = "xGF vs xGA (All Strengths, Trailing)",
        x= "xGA",
        y= "xGF",
        caption= "Data Source: Natural Stat Trick")+
   centertitle+
   centersub +
    geom_hline(yintercept = mean_xGF_ASTrailing, color = "white", linetype = "dashed") +
  geom_vline(xintercept = mean_xGA_ASTrailing, color = "white", linetype = "dashed") +
       annotate("text", x = 66, y = 62.5, 
                label = "Bad Offense/Good Defense", color="white") +
       annotate("text", x = 66, y = 110,
                label = "Good Offense/Good Defense", color="white") +
       annotate("text", x = 108, y = 62.5,
                label = "Bad Offense/Bad Defense", color="white") + 
       annotate("text", x = 108, y = 110,
                label = "Good Offense/Bad Defense", color="white")+
  theme_minimal(base_family = "Arial") + # Use a minimal theme as the base
  theme(
    plot.background = element_rect(fill = "#282a36", color = NA),
    panel.background = element_rect(fill = "#282a36", color = NA),
    plot.title = element_text(color = "white", hjust = 0.5),
    plot.subtitle = element_text(color = "white", hjust = 0.5),
    plot.caption = element_text(color = "white"),
    axis.title.x = element_text(color = "white"),
    axis.title.y = element_text(color = "white"),
    axis.text = element_text(color = "white"),
    panel.grid.major = element_blank(), # Remove major grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines

  )
```
Saving the graph to a png
```{r}
ggsave(filename = "nhl_2023_2024_ASTrailing.png", dpi=600, width = width, height = width/asp, units = "cm")
```


5)All Strengths, and Within One

Load in the data
```{r}
ASW1 <- read_csv("AllStrengthsWithinOneCounts.csv")
```

Merge with NHL Logo Data
```{r}
AS_Within1 <- left_join(ASW1,NHL_Logos,
                           by= c("Team"= "espn_team_name"))
```

Select Team Logo, xGF, xGA
```{r}
viz5 <- AS_Within1 %>% 
  select(espn_logo,xGF,xGA) %>% 
  mutate(espn_logo=replace_na(espn_logo,"https://a.espncdn.com/i/teamlogos/nhl/500/stl.png"))
```

Making the Graph: All Strengths, and Tied
```{r}
mean_xGF_ASW1 <- mean(viz5$xGF, na.rm = TRUE)
mean_xGA_ASW1 <- mean(viz5$xGA, na.rm = TRUE)
asp <- 1.618
width<- 20

#125 to 210 in both direction for limits
viz5 %>% 
  ggplot(aes(x=xGA,y=xGF,image=espn_logo))+
  geom_image(size=0.06, asp=asp)+
  labs(title= "NHL 2023-2024",
        subtitle = "xGF vs xGA (All Strengths, Within One)",
        x= "xGA",
        y= "xGF",
        caption= "Data Source: Natural Stat Trick")+
   centertitle+
   centersub +
    geom_hline(yintercept = mean_xGF_ASW1, color = "white", linetype = "dashed") +
  geom_vline(xintercept = mean_xGA_ASW1, color = "white", linetype = "dashed") +
       annotate("text", x = 153, y = 120, 
                label = "Bad Offense/Good Defense", color="white") +
       annotate("text", x = 153, y = 200,
                label = "Good Offense/Good Defense", color="white") +
       annotate("text", x = 190, y = 120,
                label = "Bad Offense/Bad Defense", color="white") + 
       annotate("text", x = 190, y = 200,
                label = "Good Offense/Bad Defense", color="white")+
  theme_minimal(base_family = "Arial") + # Use a minimal theme as the base
  theme(
    plot.background = element_rect(fill = "#282a36", color = NA),
    panel.background = element_rect(fill = "#282a36", color = NA),
    plot.title = element_text(color = "white", hjust = 0.5),
    plot.subtitle = element_text(color = "white", hjust = 0.5),
    plot.caption = element_text(color = "white"),
    axis.title.x = element_text(color = "white"),
    axis.title.y = element_text(color = "white"),
    axis.text = element_text(color = "white"),
    panel.grid.major = element_blank(), # Remove major grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines

  )
```

Saving the graph to a png
```{r}
ggsave(filename = "nhl_2023_2024_ASW1.png", dpi=600, width = width, height = width/asp, units = "cm")
```

6)All Strengths, and Up One

Load in the data
```{r}
ASU1 <- read_csv("AllStrengthsUpOneCounts.csv")
```

Merge with NHL Logo Data
```{r}
AS_Up1 <- left_join(ASU1,NHL_Logos,
                           by= c("Team"= "espn_team_name"))
```

Select Team Logo, xGF, xGA
```{r}
viz6 <- AS_Up1 %>% 
  select(espn_logo,xGF,xGA) %>% 
  mutate(espn_logo=replace_na(espn_logo,"https://a.espncdn.com/i/teamlogos/nhl/500/stl.png"))
```

Making the Graph: All Strengths, and Tied
```{r}
mean_xGF_ASU1 <- mean(viz6$xGF, na.rm = TRUE)
mean_xGA_ASU1 <- mean(viz6$xGA, na.rm = TRUE)
asp <- 1.618
width<- 20

#10 to 70 in both direction for limits
viz6 %>% 
  ggplot(aes(x=xGA,y=xGF,image=espn_logo))+
  geom_image(size=0.06, asp=asp)+
  labs(title= "NHL 2023-2024",
        subtitle = "xGF vs xGA (All Strengths, Up One)",
        x= "xGA",
        y= "xGF",
        caption= "Data Source: Natural Stat Trick")+
   centertitle+
   centersub +
    geom_hline(yintercept = mean_xGF_ASU1, color = "white", linetype = "dashed") +
  geom_vline(xintercept = mean_xGA_ASU1, color = "white", linetype = "dashed") +
       annotate("text", x = 38, y = 25, 
                label = "Bad Offense/Good Defense", color="white") +
       annotate("text", x = 38, y = 58,
                label = "Good Offense/Good Defense", color="white") +
       annotate("text", x = 58, y = 25,
                label = "Bad Offense/Bad Defense", color="white") + 
       annotate("text", x = 58, y = 58,
                label = "Good Offense/Bad Defense", color="white")+
  theme_minimal(base_family = "Arial") + # Use a minimal theme as the base
  theme(
    plot.background = element_rect(fill = "#282a36", color = NA),
    panel.background = element_rect(fill = "#282a36", color = NA),
    plot.title = element_text(color = "white", hjust = 0.5),
    plot.subtitle = element_text(color = "white", hjust = 0.5),
    plot.caption = element_text(color = "white"),
    axis.title.x = element_text(color = "white"),
    axis.title.y = element_text(color = "white"),
    axis.text = element_text(color = "white"),
    panel.grid.major = element_blank(), # Remove major grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines

  )
```
Saving the graph to a png
```{r}
ggsave(filename = "nhl_2023_2024_ASU1.png", dpi=600, width = width, height = width/asp, units = "cm")
```

7)All Strengths, and Down One

Load in the data
```{r}
ASD1 <- read_csv("AllStrengthsDownOneCounts.csv")
```

Merge with NHL Logo Data
```{r}
AS_Down1 <- left_join(ASD1,NHL_Logos,
                           by= c("Team"= "espn_team_name"))
```

Select Team Logo, xGF, xGA
```{r}
viz7 <- AS_Down1 %>% 
  select(espn_logo,xGF,xGA) %>% 
  mutate(espn_logo=replace_na(espn_logo,"https://a.espncdn.com/i/teamlogos/nhl/500/stl.png"))
```

Making the Graph: All Strengths, and Tied
```{r}
mean_xGF_ASD1 <- mean(viz7$xGF, na.rm = TRUE)
mean_xGA_ASD1 <- mean(viz7$xGA, na.rm = TRUE)
asp <- 1.618
width<- 20

#10 to 70 in both direction for limits
viz7 %>% 
  ggplot(aes(x=xGA,y=xGF,image=espn_logo))+
  geom_image(size=0.06, asp=asp)+
  labs(title= "NHL 2023-2024",
        subtitle = "xGF vs xGA (All Strengths, Down One)",
        x= "xGA",
        y= "xGF",
        caption= "Data Source: Natural Stat Trick")+
   centertitle+
   centersub +
    geom_hline(yintercept = mean_xGF_ASD1, color = "white", linetype = "dashed") +
  geom_vline(xintercept = mean_xGA_ASD1, color = "white", linetype = "dashed") +
       annotate("text", x = 32, y = 25, 
                label = "Bad Offense/Good Defense", color="white") +
       annotate("text", x = 32, y = 58,
                label = "Good Offense/Good Defense", color="white") +
       annotate("text", x = 58, y = 25,
                label = "Bad Offense/Bad Defense", color="white") + 
       annotate("text", x = 58, y = 58,
                label = "Good Offense/Bad Defense", color="white")+
  theme_minimal(base_family = "Arial") + # Use a minimal theme as the base
  theme(
    plot.background = element_rect(fill = "#282a36", color = NA),
    panel.background = element_rect(fill = "#282a36", color = NA),
    plot.title = element_text(color = "white", hjust = 0.5),
    plot.subtitle = element_text(color = "white", hjust = 0.5),
    plot.caption = element_text(color = "white"),
    axis.title.x = element_text(color = "white"),
    axis.title.y = element_text(color = "white"),
    axis.text = element_text(color = "white"),
    panel.grid.major = element_blank(), # Remove major grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines

  )
```

Saving the graph to a png
```{r}
ggsave(filename = "nhl_2023_2024_ASD1.png", dpi=600, width = width, height = width/asp, units = "cm")
```

8)Even Strength, and All Scores
```{r}
EVAS <- read_csv("EvenStrengthAllScoresCounts.csv")
NHL_Logos <- read_csv("nhl_logos.csv")
```

```{r}
EV_AllScores <- left_join(EVAS,NHL_Logos,
                           by= c("Team"= "espn_team_name"))
```
Selecting only espn_logo, xGA,xGF from the dataframe to avoid null values messing it up.
```{r}

viz8 <- EV_AllScores %>% 
  select(espn_logo,xGF,xGA) %>% 
  mutate(espn_logo=replace_na(espn_logo,"https://a.espncdn.com/i/teamlogos/nhl/500/stl.png"))
```


Making Graph: Even Strength, All Scores, xGF vs xGA
```{r}
mean_xGFEVAS <- mean(viz8$xGF, na.rm = TRUE)
mean_xGAEVAS <- mean(viz8$xGA, na.rm = TRUE)
asp <- 1.618
width<- 20

#145 to 245
viz8 %>% 
  ggplot(aes(x=xGA,y=xGF,image=espn_logo))+
  geom_image(size=0.06, asp=asp)+
  labs(title= "NHL 2023-2024",
        subtitle = "xGF vs xGA (Even Strength, All Scores)",
        x= "xGA",
        y= "xGF",
        caption= "Data Source: Natural Stat Trick")+
   centertitle+
   centersub +
    geom_hline(yintercept = mean_xGFEVAS, color = "white", linetype = "dashed") +
  geom_vline(xintercept = mean_xGAEVAS, color = "white", linetype = "dashed") +
       annotate("text", x = 172, y = 155, 
                label = "Bad Offense/Good Defense", color="white") +
       annotate("text", x = 172, y = 220,
                label = "Good Offense/Good Defense", color="white") + 
       annotate("text", x = 215, y = 155,
                label = "Bad Offense/Bad Defense", color="white") + 
       annotate("text", x = 215, y = 220,
                label = "Good Offense/Bad Defense", color="white")+
  theme_minimal(base_family = "Arial") + # Use a minimal theme as the base
  theme(
    plot.background = element_rect(fill = "#282a36", color = NA),
    panel.background = element_rect(fill = "#282a36", color = NA),
    plot.title = element_text(color = "white", hjust = 0.5),
    plot.subtitle = element_text(color = "white", hjust = 0.5),
    plot.caption = element_text(color = "white"),
    axis.title.x = element_text(color = "white"),
    axis.title.y = element_text(color = "white"),
    axis.text = element_text(color = "white"),
    panel.grid.major = element_blank(), # Remove major grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines

  )

```

Saving the plot Attempt better
```{r}
ggsave(filename = "nhl_2023_2024_EVAS.png", dpi=600, width = width, height = width/asp, units = "cm")
```


9)Even Strength, and Tied

Load in the data
```{r}
EVT <- read_csv("EvenStrengthTiedCounts.csv")
```

Merge with NHL Logo Data
```{r}
EV_Tied <- left_join(EVT,NHL_Logos,
                           by= c("Team"= "espn_team_name"))
```

Select Team Logo, xGF, xGA
```{r}
viz9 <- EV_Tied %>% 
  select(espn_logo,xGF,xGA) %>% 
  mutate(espn_logo=replace_na(espn_logo,"https://a.espncdn.com/i/teamlogos/nhl/500/stl.png"))
```

Making the Graph: All Strengths, and Tied
```{r}
mean_xGF_EVTied <- mean(viz9$xGF, na.rm = TRUE)
mean_xGA_EVTied <- mean(viz9$xGA, na.rm = TRUE)
asp <- 1.618
width<- 20

#50 to 115 in both direction for limits
viz9 %>% 
  ggplot(aes(x=xGA,y=xGF,image=espn_logo))+
  geom_image(size=0.06, asp=asp)+
  labs(title= "NHL 2023-2024",
        subtitle = "xGF vs xGA (Even Strength, Tied)",
        x= "xGA",
        y= "xGF",
        caption= "Data Source: Natural Stat Trick")+
   centertitle+
   centersub +
    geom_hline(yintercept = mean_xGF_EVTied, color = "white", linetype = "dashed") +
  geom_vline(xintercept = mean_xGA_EVTied, color = "white", linetype = "dashed") +
       annotate("text", x = 55, y = 40, 
                label = "Bad Offense/Good Defense", color="white") +
       annotate("text", x = 55, y = 85,
                label = "Good Offense/Good Defense", color="white") +
       annotate("text", x = 70, y = 40,
                label = "Bad Offense/Bad Defense", color="white") + 
       annotate("text", x = 70, y = 85,
                label = "Good Offense/Bad Defense", color="white")+
  theme_minimal(base_family = "Arial") + # Use a minimal theme as the base
  theme(
    plot.background = element_rect(fill = "#282a36", color = NA),
    panel.background = element_rect(fill = "#282a36", color = NA),
    plot.title = element_text(color = "white", hjust = 0.5),
    plot.subtitle = element_text(color = "white", hjust = 0.5),
    plot.caption = element_text(color = "white"),
    axis.title.x = element_text(color = "white"),
    axis.title.y = element_text(color = "white"),
    axis.text = element_text(color = "white"),
    panel.grid.major = element_blank(), # Remove major grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines

  )
```
Saving the graph to a png
```{r}
ggsave(filename = "nhl_2023_2024_EVTied.png", dpi=600, width = width, height = width/asp, units = "cm")
```



10)Even Strength, and Leading

Load in the data
```{r}
EVL <- read_csv("EvenStrengthLeadingCounts.csv")
```

Merge with NHL Logo Data
```{r}
EV_Leading <- left_join(EVL,NHL_Logos,
                           by= c("Team"= "espn_team_name"))
```

Select Team Logo, xGF, xGA
```{r}
viz10 <- EV_Leading %>% 
  select(espn_logo,xGF,xGA) %>% 
  mutate(espn_logo=replace_na(espn_logo,"https://a.espncdn.com/i/teamlogos/nhl/500/stl.png"))
```

Making the Graph: All Strengths, and Tied
```{r}
mean_xGF_EVLeading <- mean(viz10$xGF, na.rm = TRUE)
mean_xGA_EVLeading <- mean(viz10$xGA, na.rm = TRUE)
asp <- 1.618
width<- 20

#50 to 115 in both direction for limits
viz10 %>% 
  ggplot(aes(x=xGA,y=xGF,image=espn_logo))+
  geom_image(size=0.06, asp=asp)+
  labs(title= "NHL 2023-2024",
        subtitle = "xGF vs xGA (Even Strength, Leading)",
        x= "xGA",
        y= "xGF",
        caption= "Data Source: Natural Stat Trick")+
   centertitle+
   centersub +
    geom_hline(yintercept = mean_xGF_EVLeading, color = "white", linetype = "dashed") +
  geom_vline(xintercept = mean_xGA_EVLeading, color = "white", linetype = "dashed") +
       annotate("text", x = 48, y = 42.5, 
                label = "Bad Offense/Good Defense", color="white") +
       annotate("text", x = 48, y = 90,
                label = "Good Offense/Good Defense", color="white") +
       annotate("text", x = 75, y = 42.5,
                label = "Bad Offense/Bad Defense", color="white") + 
       annotate("text", x = 75, y = 90,
                label = "Good Offense/Bad Defense", color="white")+
  theme_minimal(base_family = "Arial") + # Use a minimal theme as the base
  theme(
    plot.background = element_rect(fill = "#282a36", color = NA),
    panel.background = element_rect(fill = "#282a36", color = NA),
    plot.title = element_text(color = "white", hjust = 0.5),
    plot.subtitle = element_text(color = "white", hjust = 0.5),
    plot.caption = element_text(color = "white"),
    axis.title.x = element_text(color = "white"),
    axis.title.y = element_text(color = "white"),
    axis.text = element_text(color = "white"),
    panel.grid.major = element_blank(), # Remove major grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines

  )
```
Saving the graph to a png
```{r}
ggsave(filename = "nhl_2023_2024_EVLeading.png", dpi=600, width = width, height = width/asp, units = "cm")
```

4)Even Strength, and Trailing

Load in the data
```{r}
EVTrail <- read_csv("EvenStrengthTrailingCounts.csv")
```

Merge with NHL Logo Data
```{r}
EV_Trailing <- left_join(EVTrail,NHL_Logos,
                           by= c("Team"= "espn_team_name"))
```

Select Team Logo, xGF, xGA
```{r}
viz11 <- EV_Trailing %>% 
  select(espn_logo,xGF,xGA) %>% 
  mutate(espn_logo=replace_na(espn_logo,"https://a.espncdn.com/i/teamlogos/nhl/500/stl.png"))
```

Making the Graph: All Strengths, and Tied
```{r}
mean_xGF_EVTrailing <- mean(viz11$xGF, na.rm = TRUE)
mean_xGA_EVTrailing <- mean(viz11$xGA, na.rm = TRUE)
asp <- 1.618
width<- 20

#50 to 115 in both direction for limits
viz11 %>% 
  ggplot(aes(x=xGA,y=xGF,image=espn_logo))+
  geom_image(size=0.06, asp=asp)+
  labs(title= "NHL 2023-2024",
        subtitle = "xGF vs xGA (Even Strength, Trailing)",
        x= "xGA",
        y= "xGF",
        caption= "Data Source: Natural Stat Trick")+
   centertitle+
   centersub +
    geom_hline(yintercept = mean_xGF_EVTrailing, color = "white", linetype = "dashed") +
  geom_vline(xintercept = mean_xGA_EVTrailing, color = "white", linetype = "dashed") +
       annotate("text", x = 50, y = 42.5, 
                label = "Bad Offense/Good Defense", color="white") +
       annotate("text", x = 50, y = 85,
                label = "Good Offense/Good Defense", color="white") +
       annotate("text", x = 88, y = 42.5,
                label = "Bad Offense/Bad Defense", color="white") + 
       annotate("text", x = 88, y = 85,
                label = "Good Offense/Bad Defense", color="white")+
  theme_minimal(base_family = "Arial") + # Use a minimal theme as the base
  theme(
    plot.background = element_rect(fill = "#282a36", color = NA),
    panel.background = element_rect(fill = "#282a36", color = NA),
    plot.title = element_text(color = "white", hjust = 0.5),
    plot.subtitle = element_text(color = "white", hjust = 0.5),
    plot.caption = element_text(color = "white"),
    axis.title.x = element_text(color = "white"),
    axis.title.y = element_text(color = "white"),
    axis.text = element_text(color = "white"),
    panel.grid.major = element_blank(), # Remove major grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines

  )
```
Saving the graph to a png
```{r}
ggsave(filename = "nhl_2023_2024_EVTrailing.png", dpi=600, width = width, height = width/asp, units = "cm")
```


12)Even Strength, and Within One

Load in the data
```{r}
EVW1 <- read_csv("EvenStrengthWithinOneCounts.csv")
```

Merge with NHL Logo Data
```{r}
EV_Within1 <- left_join(EVW1,NHL_Logos,
                           by= c("Team"= "espn_team_name"))
```

Select Team Logo, xGF, xGA
```{r}
viz12 <- EV_Within1 %>% 
  select(espn_logo,xGF,xGA) %>% 
  mutate(espn_logo=replace_na(espn_logo,"https://a.espncdn.com/i/teamlogos/nhl/500/stl.png"))
```

Making the Graph: All Strengths, and Tied
```{r}
mean_xGF_EVW1 <- mean(viz12$xGF, na.rm = TRUE)
mean_xGA_EVW1 <- mean(viz12$xGA, na.rm = TRUE)
asp <- 1.618
width<- 20

#125 to 210 in both direction for limits
viz12 %>% 
  ggplot(aes(x=xGA,y=xGF,image=espn_logo))+
  geom_image(size=0.06, asp=asp)+
  labs(title= "NHL 2023-2024",
        subtitle = "xGF vs xGA (Even Strength, Within One)",
        x= "xGA",
        y= "xGF",
        caption= "Data Source: Natural Stat Trick")+
   centertitle+
   centersub +
    geom_hline(yintercept = mean_xGF_EVW1, color = "white", linetype = "dashed") +
  geom_vline(xintercept = mean_xGA_EVW1, color = "white", linetype = "dashed") +
       annotate("text", x = 112, y = 80, 
                label = "Bad Offense/Good Defense", color="white") +
       annotate("text", x = 112, y = 160,
                label = "Good Offense/Good Defense", color="white") +
       annotate("text", x = 145, y = 80,
                label = "Bad Offense/Bad Defense", color="white") + 
       annotate("text", x = 145, y = 160,
                label = "Good Offense/Bad Defense", color="white")+
  theme_minimal(base_family = "Arial") + # Use a minimal theme as the base
  theme(
    plot.background = element_rect(fill = "#282a36", color = NA),
    panel.background = element_rect(fill = "#282a36", color = NA),
    plot.title = element_text(color = "white", hjust = 0.5),
    plot.subtitle = element_text(color = "white", hjust = 0.5),
    plot.caption = element_text(color = "white"),
    axis.title.x = element_text(color = "white"),
    axis.title.y = element_text(color = "white"),
    axis.text = element_text(color = "white"),
    panel.grid.major = element_blank(), # Remove major grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines

  )
```

Saving the graph to a png
```{r}
ggsave(filename = "nhl_2023_2024_EVW1.png", dpi=600, width = width, height = width/asp, units = "cm")
```

13)Even Strength, and Up One

Load in the data
```{r}
EVU1 <- read_csv("EvenStrengthUpOneCounts.csv")
```

Merge with NHL Logo Data
```{r}
EV_Up1 <- left_join(EVU1,NHL_Logos,
                           by= c("Team"= "espn_team_name"))
```

Select Team Logo, xGF, xGA
```{r}
viz13 <- EV_Up1 %>% 
  select(espn_logo,xGF,xGA) %>% 
  mutate(espn_logo=replace_na(espn_logo,"https://a.espncdn.com/i/teamlogos/nhl/500/stl.png"))
```

Making the Graph: All Strengths, and Tied
```{r}
mean_xGF_EVU1 <- mean(viz13$xGF, na.rm = TRUE)
mean_xGA_EVU1 <- mean(viz13$xGA, na.rm = TRUE)
asp <- 1.618
width<- 20

#10 to 70 in both direction for limits
viz13 %>% 
  ggplot(aes(x=xGA,y=xGF,image=espn_logo))+
  geom_image(size=0.06, asp=asp)+
  labs(title= "NHL 2023-2024",
        subtitle = "xGF vs xGA (Even Strength, Up One)",
        x= "xGA",
        y= "xGF",
        caption= "Data Source: Natural Stat Trick")+
   centertitle+
   centersub +
    geom_hline(yintercept = mean_xGF_EVU1, color = "white", linetype = "dashed") +
  geom_vline(xintercept = mean_xGA_EVU1, color = "white", linetype = "dashed") +
       annotate("text", x = 26, y = 18, 
                label = "Bad Offense/Good Defense", color="white") +
       annotate("text", x = 26, y = 50,
                label = "Good Offense/Good Defense", color="white") +
       annotate("text", x = 42, y = 18,
                label = "Bad Offense/Bad Defense", color="white") + 
       annotate("text", x = 42, y = 50,
                label = "Good Offense/Bad Defense", color="white")+
  theme_minimal(base_family = "Arial") + # Use a minimal theme as the base
  theme(
    plot.background = element_rect(fill = "#282a36", color = NA),
    panel.background = element_rect(fill = "#282a36", color = NA),
    plot.title = element_text(color = "white", hjust = 0.5),
    plot.subtitle = element_text(color = "white", hjust = 0.5),
    plot.caption = element_text(color = "white"),
    axis.title.x = element_text(color = "white"),
    axis.title.y = element_text(color = "white"),
    axis.text = element_text(color = "white"),
    panel.grid.major = element_blank(), # Remove major grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines

  )
```
Saving the graph to a png
```{r}
ggsave(filename = "nhl_2023_2024_EVU1.png", dpi=600, width = width, height = width/asp, units = "cm")
```

14)Even Strength, and Down One

Load in the data
```{r}
EVD1 <- read_csv("EvenStrengthDownOneCounts.csv")
```

Merge with NHL Logo Data
```{r}
EV_Down1 <- left_join(EVD1,NHL_Logos,
                           by= c("Team"= "espn_team_name"))
```

Select Team Logo, xGF, xGA
```{r}
viz14 <- EV_Down1 %>% 
  select(espn_logo,xGF,xGA) %>% 
  mutate(espn_logo=replace_na(espn_logo,"https://a.espncdn.com/i/teamlogos/nhl/500/stl.png"))
```

Making the Graph: All Strengths, and Tied
```{r}
mean_xGF_EVD1 <- mean(viz14$xGF, na.rm = TRUE)
mean_xGA_EVD1 <- mean(viz14$xGA, na.rm = TRUE)
asp <- 1.618
width<- 20

#10 to 70 in both direction for limits
viz14 %>% 
  ggplot(aes(x=xGA,y=xGF,image=espn_logo))+
  geom_image(size=0.06, asp=asp)+
  labs(title= "NHL 2023-2024",
        subtitle = "xGF vs xGA (Even Strength, Down One)",
        x= "xGA",
        y= "xGF",
        caption= "Data Source: Natural Stat Trick")+
   centertitle+
   centersub +
    geom_hline(yintercept = mean_xGF_EVD1, color = "white", linetype = "dashed") +
  geom_vline(xintercept = mean_xGA_EVD1, color = "white", linetype = "dashed") +
       annotate("text", x = 26, y = 25, 
                label = "Bad Offense/Good Defense", color="white") +
       annotate("text", x = 26, y = 45,
                label = "Good Offense/Good Defense", color="white") +
       annotate("text", x = 42, y = 25,
                label = "Bad Offense/Bad Defense", color="white") + 
       annotate("text", x = 42, y = 45,
                label = "Good Offense/Bad Defense", color="white")+
  theme_minimal(base_family = "Arial") + # Use a minimal theme as the base
  theme(
    plot.background = element_rect(fill = "#282a36", color = NA),
    panel.background = element_rect(fill = "#282a36", color = NA),
    plot.title = element_text(color = "white", hjust = 0.5),
    plot.subtitle = element_text(color = "white", hjust = 0.5),
    plot.caption = element_text(color = "white"),
    axis.title.x = element_text(color = "white"),
    axis.title.y = element_text(color = "white"),
    axis.text = element_text(color = "white"),
    panel.grid.major = element_blank(), # Remove major grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines

  )
```

Saving the graph to a png
```{r}
ggsave(filename = "nhl_2023_2024_EVD1.png", dpi=600, width = width, height = width/asp, units = "cm")
```

15)5v5, and All Scores 
16)5v5, and Tied 
17)5v5, and Leading 
18)5v5, and Trailing
19)5v5, and Within One
20)5v5, and Up One 
21)5v5, and Down One

22)Score and Venue adjusted 5v5, and All Scores 
23)Score and Venue adjusted 5v5, and Tied 
24)Score and Venue adjusted 5v5, and Leading 
25)Score and Venue adjusted 5v5, and Trailing
26)Score and Venue adjusted 5v5, and Within One
27)Score and Venue adjusted 5v5, and Up One 
28)Score and Venue adjusted 5v5, and Down One


